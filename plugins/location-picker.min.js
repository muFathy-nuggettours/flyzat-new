!function(a){window.console||(window.console={}),window.console.log||(window.console.log=function(){}),a.fn.gMapsLatLonPicker=function(){var s=this;s.params={defLat:0,defLng:0,defZoom:1,queryLocationNameWhenLatLngChanges:!0,queryElevationWhenLatLngChanges:!0,mapOptions:{mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,disableDoubleClickZoom:!0,zoomControlOptions:!0,streetViewControl:!1},strings:{markerText:"",error_empty_field:"",error_no_results:""},displayError:function(a){console.log(a)}},s.vars={ID:null,LATLNG:null,map:null,marker:null,geocoder:null};var o=function(o){s.vars.marker.setPosition(o),s.vars.map.panTo(o),a(s.vars.cssID+".gllpZoom").val(s.vars.map.getZoom()),a(s.vars.cssID+".gllpLongitude").val(o.lng()),a(s.vars.cssID+".gllpLatitude").val(o.lat()),a(s.vars.cssID).trigger("location_changed",a(s.vars.cssID)),s.params.queryLocationNameWhenLatLngChanges&&e(o),s.params.queryElevationWhenLatLngChanges&&r(o)},e=function(o){var e=new google.maps.LatLng(o.lat(),o.lng());s.vars.geocoder.geocode({latLng:e},function(o,e){e==google.maps.GeocoderStatus.OK&&o[1]?a(s.vars.cssID+".gllpLocationName").val(o[1].formatted_address):a(s.vars.cssID+".gllpLocationName").val(""),a(s.vars.cssID).trigger("location_name_changed",a(s.vars.cssID))})},r=function(o){var e={locations:[new google.maps.LatLng(o.lat(),o.lng())]};s.vars.elevator.getElevationForLocations(e,function(o,e){e==google.maps.ElevationStatus.OK&&o[0]?a(s.vars.cssID+".gllpElevation").val(o[0].elevation.toFixed(3)):a(s.vars.cssID+".gllpElevation").val(""),a(s.vars.cssID).trigger("elevation_changed",a(s.vars.cssID))})},n=function(e,r){""!=e?s.vars.geocoder.geocode({address:e},function(e,n){n==google.maps.GeocoderStatus.OK?(a(s.vars.cssID+".gllpZoom").val(11),s.vars.map.setZoom(parseInt(a(s.vars.cssID+".gllpZoom").val())),o(e[0].geometry.location)):r||s.params.displayError(s.params.strings.error_no_results)}):r||s.params.displayError(s.params.strings.error_empty_field)};return{init:function(e){a(e).attr("id")||(a(e).attr("name")?a(e).attr("id",a(e).attr("name")):a(e).attr("id","_MAP_"+Math.ceil(1e4*Math.random()))),s.vars.ID=a(e).attr("id"),s.vars.cssID="#"+s.vars.ID+" ",s.params.defLat=a(s.vars.cssID+".gllpLatitude").val()?a(s.vars.cssID+".gllpLatitude").val():s.params.defLat,s.params.defLng=a(s.vars.cssID+".gllpLongitude").val()?a(s.vars.cssID+".gllpLongitude").val():s.params.defLng,s.params.defZoom=a(s.vars.cssID+".gllpZoom").val()?parseInt(a(s.vars.cssID+".gllpZoom").val()):s.params.defZoom,s.vars.LATLNG=new google.maps.LatLng(s.params.defLat,s.params.defLng),s.vars.MAPOPTIONS=s.params.mapOptions,s.vars.MAPOPTIONS.zoom=s.params.defZoom,s.vars.MAPOPTIONS.center=s.vars.LATLNG,s.vars.map=new google.maps.Map(a(s.vars.cssID+".gllpMap").get(0),s.vars.MAPOPTIONS),s.vars.geocoder=new google.maps.Geocoder,s.vars.elevator=new google.maps.ElevationService,s.vars.marker=new google.maps.Marker({position:s.vars.LATLNG,map:s.vars.map,title:s.params.strings.markerText,draggable:!0}),google.maps.event.addListener(s.vars.map,"dblclick",function(a){o(a.latLng)}),google.maps.event.addListener(s.vars.marker,"dragend",function(a){o(s.vars.marker.position)}),google.maps.event.addListener(s.vars.map,"zoom_changed",function(o){a(s.vars.cssID+".gllpZoom").val(s.vars.map.getZoom()),a(s.vars.cssID).trigger("location_changed",a(s.vars.cssID))}),a(s.vars.cssID+".gllpUpdateButton").bind("click",function(){var e=a(s.vars.cssID+".gllpLatitude").val(),r=a(s.vars.cssID+".gllpLongitude").val(),n=new google.maps.LatLng(e,r);s.vars.map.setZoom(parseInt(a(s.vars.cssID+".gllpZoom").val())),o(n)}),a(s.vars.cssID+".gllpSearchButton").bind("click",function(){n(a(s.vars.cssID+".gllpSearchField").val(),!1)}),a(document).bind("gllp_perform_search",function(s,o){n(a(o).attr("string"),!0)}),a(document).bind("gllp_update_fields",function(e){var r=a(s.vars.cssID+".gllpLatitude").val(),n=a(s.vars.cssID+".gllpLongitude").val(),l=new google.maps.LatLng(r,n);s.vars.map.setZoom(parseInt(a(s.vars.cssID+".gllpZoom").val())),o(l)})},params:s.params}}}(jQuery);